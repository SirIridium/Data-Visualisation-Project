This is the final code:
As in it is formatted and cleaned.
